<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ride Logger</title>
    <!-- Use Tailwind CSS for easy styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }
    </style>
</head>
<body>

    <!-- Main container for the app, with responsive styling -->
    <div class="bg-white p-8 md:p-12 rounded-2xl shadow-xl max-w-lg w-full">
        <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">Log Your Ride</h1>
        
        <!-- Form for ride data input -->
        <form id="rideForm" class="space-y-6">
            
            <!-- Location input field -->
            <div>
                <label for="location" class="block text-sm font-medium text-gray-700 mb-1">
                    Current Location
                </label>
                <input type="text" id="location" name="location" placeholder="e.g., Home"
                    class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out"
                    required>
            </div>
            
            <!-- Destination input field -->
            <div>
                <label for="destination" class="block text-sm font-medium text-gray-700 mb-1">
                    Destination
                </label>
                <input type="text" id="destination" name="destination" placeholder="e.g., Downtown"
                    class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out"
                    required>
            </div>
            
            <!-- Distance input field -->
            <div>
                <label for="distance" class="block text-sm font-medium text-gray-700 mb-1">
                    Distance (in km)
                </label>
                <input type="number" id="distance" name="distance" placeholder="e.g., 5.2"
                    class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out"
                    step="0.01" required>
            </div>
            
            <!-- Submit button with loading state -->
            <div>
                <button type="submit" id="submitBtn"
                    class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-lg font-semibold text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed">
                    Log Ride
                </button>
            </div>
        </form>

        <!-- Message box for success or error feedback -->
        <div id="messageBox" class="mt-6 p-4 rounded-lg text-sm hidden"></div>
        
    </div>

    <!-- JavaScript for form submission and API call -->
    <script>
        document.getElementById('rideForm').addEventListener('submit', async function(event) {
            event.preventDefault(); // Prevent the default form submission

            const form = event.target;
            const submitBtn = document.getElementById('submitBtn');
            const messageBox = document.getElementById('messageBox');
            
            // Disable the button and show a loading state
            submitBtn.disabled = true;
            submitBtn.textContent = 'Logging...';
            messageBox.classList.add('hidden');

            const formData = {
                location: form.location.value,
                destination: form.destination.value,
                distance: parseFloat(form.distance.value)
            };
            
            // === IMPORTANT: REPLACE THIS URL WITH YOUR NEW DEPLOYED SCRIPT URL ===
            const scriptUrl = 'https://script.google.com/macros/s/AKfycbzUMaw7_Nunl8tLYyo6NAqFpDRoe7JLZ935_zUZMqwR-AJ1flRI-JISlJ5xyC4izS4Acw/exec'; 

            try {
                const response = await fetch(scriptUrl, {
                    method: 'POST',
                    mode: 'no-cors', // Use no-cors mode for cross-origin requests
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });
                
                // Since we are using no-cors, we cannot check the response status.
                // We will assume success for now and provide feedback to the user.
                
                showMessage('success', 'Ride logged successfully!');
                form.reset(); // Reset the form fields on success

            } catch (error) {
                console.error('Error:', error);
                showMessage('error', 'An error occurred. Please try again.');
            } finally {
                // Re-enable the button and restore its original text
                submitBtn.disabled = false;
                submitBtn.textContent = 'Log Ride';
            }
        });

        // Helper function to display messages to the user
        function showMessage(type, message) {
            const messageBox = document.getElementById('messageBox');
            messageBox.textContent = message;
            messageBox.classList.remove('hidden');
            
            // Apply styling based on the message type (success or error)
            if (type === 'success') {
                messageBox.classList.remove('bg-red-100', 'text-red-800');
                messageBox.classList.add('bg-green-100', 'text-green-800');
            } else if (type === 'error') {
                messageBox.classList.remove('bg-green-100', 'text-green-800');
                messageBox.classList.add('bg-red-100', 'text-red-800');
            }
        }
    </script>
</body>
</html>
